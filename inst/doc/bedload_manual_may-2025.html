<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Bedload Manual</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Bedload Manual</h1>



<div id="background" class="section level1">
<h1>Background</h1>
<p>The bedload package was created to automate the performance of
various analyses that come up in applied geoscience. The philosophy of
the package is to construct flexible tools that can be easily
incorporated into data analysis workflows without a detailed background
in R programming. It relies on other packages for importing and
analyzing various types of environmental data that are used when
analyzing questions related to bed material transport.</p>
</div>
<div id="analysis-functions" class="section level1">
<h1>Analysis Functions</h1>
<p>The analysis functions in this section are designed to perform a
range of commonly executed analyses. They are built with various
functions from the subsequent sections. The typical workflows are
presented with each analysis function.</p>
<p>New analysis functions will continue to be added to the
<code>bedload</code> package as new use cases are developed.</p>
<hr />
<div id="compare_fun" class="section level2">
<h2>compare_fun</h2>
<p>This function compares the transport functions for a specified grain
size and channel gradient over a reasonable range of shear stress values
using the default values for all functions.</p>
<div id="usage" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>compare_fun(d, S, d84 = 2 * d, g = 9.81, rho = 1000, rho_s = 2650)</code></p>
</div>
<div id="arguments" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d84</code> 84th percentile diameter of bed sediment (m).
Defaults to <code>2 * d</code></p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function is intended to visualize how the various transport
functions compare with one another for a given grain size and energy
gradient. The results depend in large part on the relative roughness of
the stream be analysed, which is implicit in the choice of grain size
and gradient.</p>
</div>
<div id="output" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function simply produces a graph of the calculated volumetric
bedload transport rate per unit width for a specified range of
dimensionless shear stress values.</p>
</div>
<div id="examples" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>Here is an example for a steep stream with high relative
roughness.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">compare_fun</span>(<span class="at">d =</span> <span class="fl">0.05</span>, </span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>            <span class="at">S =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>And here is an example for a stream with much lower gradient and
lower relative roughness.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">compare_fun</span>(<span class="at">d =</span> <span class="fl">0.05</span>, </span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>            <span class="at">S =</span> <span class="fl">0.0002</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="see-also" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>mpm()</code>, <code>wp()</code>, <code>eb()</code>,
<code>yln()</code>, <code>vr()</code>, <code>ec()</code>,
<code>rk()</code></p>
<hr />
</div>
</div>
<div id="estimate_hydraulics" class="section level2">
<h2>estimate_hydraulics</h2>
<p>this function estimates hydraulic properties at regular WSE elevation
intervals, effectively building a rating curve and mapping out the
at-a-station hydraulic geometry for the cross section being analyzed.
These data can be used to interpolate values for target flow values. The
calculations include estimates of the bedload flux calculated using one
of several bedload transport equations.</p>
<div id="usage-1" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>estimate_hydraulics(xs_data, S, d, d84 = 2 * d, ymax = 1.5, ...</code>
<code>dx = 0.05, t_crit = t_crit_soul(d), g = 9.81, rho = 1000, ...</code>
<code>rho_s = 2650, a1 = 6.5, a2 = 2.5, kv = 1e-06, fun = &quot;ec&quot;, rp = FALSE)</code></p>
</div>
<div id="arguments-1" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>xs_data</code> a data frame containing variables
<code>dist</code> (distances) and <code>z</code> (elevations)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>d84</code> 84th percentile diameter of bed sediment (m).
Defaults to 2 * d</p></li>
<li><p><code>ymax</code> the maximum flow depth to model, measured at
the thalweg, defaults to 3.5 m</p></li>
<li><p><code>dx</code> the increment by which to change stage. defaults
to 0.05 m</p></li>
<li><p><code>t_crit</code> critical dimensionless shear stress,
calculated using the Soulsby (1997) equation</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>a1</code> constant fit by Ferguson (2007). Defaults to
6.5</p></li>
<li><p><code>a2</code> constant fit by Ferguson (2007). Defaults to
2.5</p></li>
<li><p><code>kv</code> kinematic viscosity of water. Defaults to
1e-6</p></li>
<li><p><code>fun</code> choice of bedload function: ‘eb’,‘ec’, ‘rk’,
‘mpm’, ‘vr’,‘wp’, ‘yln’. Defaults to ‘ec’</p></li>
<li><p><code>rp</code> option for ‘rk’ select equation suited to riffle
pool morphology, default is FALSE</p></li>
</ul>
</div>
<div id="details-1" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses the Ferguson (2007) flow resistance equation to
calculate the velocity for a sequence of water depths at a given cross
section. It builds a dataset of hydraulic geometry values (mean depth,
water surface width, wetted perimeter), and cross section-average
hydraulic parameters (velocity, shear stress, bedload transport
capacity) for a range of discharges.</p>
</div>
<div id="output-1" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function produces a data frame containing estimates of the mean
area of flow (area),flow width (width), wetted parameter (perimeter),
mean flow velocity (velocity), bed load transport capacity (transport),
water surface elevation (wse), and dimensionless shear stress (t_star)
for a range of discharge values (flow).</p>
</div>
<div id="examples-1" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>To use <code>estimate_hydraulics()</code> it is necessary to have at
a minimum a topographic cross section, an estimate of the reach-average
gradient, and an estimate of the mean surface grain size.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>example_section <span class="ot">&lt;-</span> <span class="fu">make_trapezoid</span>(<span class="at">w_top =</span> <span class="dv">10</span>,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                                  <span class="at">w_bot =</span> <span class="dv">5</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                                  <span class="at">H_bank =</span> <span class="fl">1.5</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                                  <span class="at">Z_fp =</span> <span class="dv">100</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">plot</span>(example_section<span class="sc">$</span>dist, example_section<span class="sc">$</span>Z,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;distance (m)&quot;</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;elevation (m)&quot;</span>,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>example_slope <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>example_d <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>example_result <span class="ot">&lt;-</span> <span class="fu">estimate_hydraulics</span>(<span class="at">xs_data =</span> example_section,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                                      <span class="at">S =</span> example_slope,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                                      <span class="at">d =</span> example_d)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">head</span>(example_result)</span></code></pre></div>
<pre><code>##         flow  area width perimeter  velocity    transport   wse     t_star
## 1 0.00000000 0.000   5.1  5.116619 0.0000000 0.0000000000 98.50 0.00000000
## 2 0.06010608 0.255   5.1  5.116619 0.2357101 0.0004518848 98.55 0.03775576
## 3 0.31137738 0.518   5.3  5.349857 0.6011146 0.0033290477 98.60 0.07335228
## 4 0.78039976 0.789   5.5  5.583095 0.9890998 0.0091788685 98.65 0.10706020
## 5 1.45819648 1.068   5.7  5.816333 1.3653525 0.0178683504 98.70 0.13910670
## 6 2.32846026 1.355   5.9  6.049571 1.7184209 0.0291474408 98.75 0.16968395</code></pre>
</div>
<div id="see-also-1" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>load_section()</code>, <code>make_trapezoid()</code>,</p>
<hr />
</div>
</div>
<div id="estimate_capacity" class="section level2">
<h2>estimate_capacity</h2>
<p>this function uses a data frame created by the
<code>estimate_hydraulics()</code> utility function to approximate the
volume of bed material that could be transported during a hydrograph. It
also estimates the geomorphically active volume of transport based on a
threshold dimensionless shear stress.</p>
<div id="usage-2" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>estimate_capacity(xs_hyd, Q, t, tc = 0.08, mkplt = FALSE)</code></p>
</div>
<div id="arguments-2" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>xs_hyd</code> a data frame created by
<code>estimate_hydraulics()</code></p></li>
<li><p><code>Q</code> a vector containing the flows that define the
hydrograph</p></li>
<li><p><code>t</code> a vector that contains the corresponding times for
each Q value (hours)</p></li>
<li><p><code>tc</code> the threshold dimensionless shear stress for
channel change</p></li>
<li><p><code>mkplt</code> option to make a plot of the data, defaults to
FALSE</p></li>
</ul>
</div>
<div id="details-2" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function first requires the user to create: a data frame using
the <code>estimate_hydraulics()</code> function; and two vectors that
define an event hydrograph over which to integrate the sediment
transport capacity.</p>
</div>
<div id="output-2" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function outputs a data frame with the following information:</p>
<ul>
<li><code>Qmax</code> peak flow of the hydrograph (cubic meters per
sec)</li>
<li><code>vol_transp</code> volume of bedload transported during
hydrograph (cubic meters)</li>
<li><code>vol_active</code> volume of bedload transported when shear
stresses exceeded a user-specified threshold dimensionless shear stress
for channel change (cubic meters)</li>
<li><code>width</code> maximum width of the channel during the flood
(m)</li>
<li><code>vel</code> maximum cross sectional average flow velocity
(m/s)</li>
<li><code>area</code> maximum cross sectional area for flow (m<span class="math inline">\(^2\)</span>/s)</li>
<li><code>wse</code> maximum water surface elevation during the peak
flow (m)</li>
</ul>
</div>
<div id="examples-2" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>The code below provides an example of a typical work flow involved in
making the calculation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># enter data that you have from the field on the site of interest</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>test_d <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># median surface texture, ideally from a Wolman sample</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>test_d84 <span class="ot">&lt;-</span> <span class="fl">0.12</span>  <span class="co">#the 84th percentile of the bed surface</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>test_slope <span class="ot">&lt;-</span> <span class="fl">0.015</span>  <span class="co"># reach average bed slope from lidar or map</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>top_width <span class="ot">&lt;-</span> <span class="dv">12</span>  <span class="co"># bank to bank width at the site</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>bot_width <span class="ot">&lt;-</span> <span class="fl">3.5</span>  <span class="co"># width of the channel bed </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>bank_ht <span class="ot">&lt;-</span> <span class="fl">1.2</span>  <span class="co"># vertical high of the floodplain above the channel bed</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co"># make a cross section for analysis based on field measurements</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#(you can also is load_section() to load a more detailt topo profile)</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>test_section <span class="ot">&lt;-</span> <span class="fu">make_trapezoid</span>(<span class="at">w_top =</span> top_width,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                               <span class="at">w_bot =</span> bot_width,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>                               <span class="at">H_bank =</span> bank_ht,</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>                               <span class="at">Z_fp =</span> <span class="dv">100</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co"># use the scs_hydrograph() function to produce a hydrograph</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>test_Q_peak <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="co"># in cubic meters per second</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>test_time_lag <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="co">#in hours</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>test_dt <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">/</span><span class="dv">60</span> <span class="co">#produce discharge output every 15 minutes</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>test_hydrograph <span class="ot">&lt;-</span> <span class="fu">scs_hydrograph</span>(<span class="at">Qpeak =</span> test_Q_peak,</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>                                  <span class="at">tpeak =</span> test_time_lag, </span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>                                  <span class="at">dt =</span> test_dt)</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="fu">plot</span>(test_hydrograph)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># now we are ready to run estimate_hydraulics...</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>test_df <span class="ot">&lt;-</span> <span class="fu">estimate_hydraulics</span>(<span class="at">xs_data =</span> test_section,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                               <span class="at">S =</span> test_slope,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                               <span class="at">d =</span> test_d,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                               <span class="at">d84 =</span> test_d84,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                               <span class="at">ymax =</span> bank_ht <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                               <span class="at">fun =</span> <span class="st">&quot;mpm&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                               )</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: the optional parameter ymax was assigned a value twice the channel depth...this is not strictly necessary, but ymax controls the range of water depths (and discharge values) analysed by the function, and the next step requires a data frame with discharge values at least as high as the peak flow being assessed.</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co"># now we can run the integration over the hydrograph</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>test_output <span class="ot">&lt;-</span> <span class="fu">estimate_capacity</span>(<span class="at">xs_hyd =</span> test_df, </span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>                                 <span class="at">Q =</span> test_hydrograph<span class="sc">$</span>y,</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>                                 <span class="at">t =</span> test_hydrograph<span class="sc">$</span>x)</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="fu">print</span>(test_output)</span></code></pre></div>
<pre><code>##   Qmax vol_transp vol_active    width      vel     area      wse
## 1   12   853.1535   780.8163 9.779734 2.041883 5.872919 99.68497</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># and we can show the peak water surface elevation on the cross section to check that things make sense</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">plot</span>(test_section, <span class="at">asp =</span> <span class="dv">2</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> test_output<span class="sc">$</span>wse, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="see-also-2" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>fractional_capacity()</code>, <code>bank_erode_fp</code>,
<code>bank_erode_trc()</code></p>
<hr />
</div>
</div>
<div id="fractional_capacity" class="section level2">
<h2>fractional_capacity</h2>
<p>Integrating the Wilcock and Crowe (2003) fractional bedload transport
function over a hydrograph</p>
<div id="usage-3" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>fractional_capacity(   hydrograph,   xs_data,   S,   gsd,   Fsand,   g = 9.81,   rho = 1000,   rho_s = 2650 )</code></p>
</div>
<div id="arguments-3" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>hydrograph</code> a data frame created by
<code>scs_hydrograph()</code> (Q in m<span class="math inline">\(^3\)</span>/s and t in hours</p></li>
<li><p><code>xs_data</code> a data frame containing topography expressed
as dist (distances) and z (elevations)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>gsd</code> a data frame describing the grain size
distribution created with function <code>wolman_gsd()</code></p></li>
<li><p><code>Fsand</code> proportion of the surface that is covered by
sand sized sediment (affects entrainment, typically varies from 0 to
0.2)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-3" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function integrates the Wilcock and Crowe transport function
over a hydrograph for a given cross section to estimate the total
fractional transport volumes for the flood event. Output includes the
inputted GSD information for each size class (Di, cpf, Dm, Fi), as well
as the volumetric transport rate (Qbi), and the fraction of the computed
bedload in each size class (Li)</p>
</div>
<div id="output-3" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function outputs a data frame with the following information:</p>
<ul>
<li><code>Di</code> grain size (in mm) of the upper size of each size
class analyzed</li>
<li><code>cpf</code> cumulative proportion finer than each size
<code>Di</code></li>
<li><code>dm</code> median size for each size class analyzed</li>
<li><code>Fi</code> fraction of the bed surface in each size class</li>
<li><code>Qbi</code> volume of sediment transported during the
hydrograph for each size class</li>
<li><code>Li</code> the fraction of the total transported volume in each
size class</li>
</ul>
</div>
<div id="examples-3" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>The function is used in the following example to analyze the
potential rate and grain size distribution of bedload transport in a
small gravel bed stream during a flood, using the test data created to
demonstrate the <code>estimate_capacity</code> function. The
<code>wolman_gsd()</code> function is used to generate a data frame with
the necessary grain size distribution information in it to run the
Wilcock and Crowe model. Alternatively, you can use the
<code>sim_gsd()</code> function to simulate a log-normal grain size
distribution.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#example gsd data</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>field_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">23</span>, <span class="dv">32</span>, <span class="dv">45</span>, <span class="dv">64</span>, <span class="dv">91</span>, <span class="dv">128</span>, <span class="dv">181</span>, <span class="dv">256</span>, <span class="dv">360</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>field_counts <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">17</span>, <span class="dv">11</span>, <span class="dv">9</span>, <span class="dv">5</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>test_gsd <span class="ot">&lt;-</span> <span class="fu">wolman_gsd</span>(<span class="at">Di =</span> field_sizes, </span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                  <span class="at">counts =</span> field_counts)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#assume a percent sand for the bed surface</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>test_fsand <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="sc">/</span> <span class="dv">100</span>  </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>test_output <span class="ot">&lt;-</span> <span class="fu">fractional_capacity</span>(<span class="at">hydrograph =</span> test_hydrograph,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                                    <span class="at">xs_data =</span> test_section,</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>                                    <span class="at">S =</span> test_slope,</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>                                    <span class="at">gsd =</span> test_gsd,</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>                                    <span class="at">Fsand =</span> test_fsand)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="fu">print</span>(test_output)</span></code></pre></div>
<pre><code>##     Di        cpf        dm         Fi          Qbi           Li
## 10 360 1.00000000 303.57866 0.04716981 5.686614e-06 1.290465e-08
## 9  256 0.95283019 215.25798 0.08490566 1.330440e-03 3.019171e-06
## 8  181 0.86792453 152.21038 0.10377358 1.555404e-01 3.529683e-04
## 7  128 0.76415094 107.92590 0.16037736 6.650807e+00 1.509269e-02
## 6   91 0.60377358  76.31514 0.18867925 3.801620e+01 8.627024e-02
## 5   64 0.41509434  53.66563 0.16981132 8.688477e+01 1.971678e-01
## 4   45 0.24528302  37.94733 0.14150943 1.341123e+02 3.043413e-01
## 3   32 0.10377358  27.12932 0.06603774 9.682496e+01 2.197251e-01
## 2   23 0.03773585  19.18333 0.03773585 7.801819e+01 1.770469e-01
## 1   16 0.00000000  16.00000 0.00000000 0.000000e+00 0.000000e+00</code></pre>
<p>The total volume of sediment transported during the flood can be
estimated by summing the values</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>total_transport_volume <span class="ot">&lt;-</span> <span class="fu">sum</span>(test_output<span class="sc">$</span>Qbi)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(total_transport_volume))</span></code></pre></div>
<pre><code>## [1] 441</code></pre>
<p>The grain size distribution of the bed material and of the load can
also be compared.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">plot</span>(test_output<span class="sc">$</span>dm, <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(test_output<span class="sc">$</span>Fi))),</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>     <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>     <span class="at">log =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Grain size (mm)&quot;</span>,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Cumulative proportion finer&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="fu">points</span>(test_output<span class="sc">$</span>dm, <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(test_output<span class="sc">$</span>Li))),</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="fu">lines</span>(test_output<span class="sc">$</span>dm, <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(test_output<span class="sc">$</span>Li))),</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This analysis can also be performed if you only have an estimate of
the bed D50 and D84 by simulating a log-normal grain size
distribution.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co">#pick a D50 and log-normal standard deviation that gives the same D50 and D84 as the Wolman sample above</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>D50 <span class="ot">&lt;-</span> <span class="fu">approx</span>(<span class="at">x =</span> test_output<span class="sc">$</span>cpf,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>              <span class="at">y =</span> test_output<span class="sc">$</span>Di,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>              <span class="at">xout =</span> <span class="fl">0.5</span>)[[<span class="dv">2</span>]]</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fl">1.08</span> </span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>test_gsd <span class="ot">&lt;-</span> <span class="fu">sim_gsd</span>(D50, sp)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>test_output <span class="ot">&lt;-</span> <span class="fu">fractional_capacity</span>(<span class="at">hydrograph =</span> test_hydrograph,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>                                    <span class="at">xs_data =</span> test_section,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>                                    <span class="at">S =</span> test_slope,</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>                                    <span class="at">gsd =</span> test_gsd,</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>                                    <span class="at">Fsand =</span> test_fsand)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>total_transport_volume <span class="ot">&lt;-</span> <span class="fu">sum</span>(test_output<span class="sc">$</span>Qbi)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(total_transport_volume))</span></code></pre></div>
<pre><code>## [1] 436</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plot</span>(test_output<span class="sc">$</span>dm, <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(test_output<span class="sc">$</span>Fi))),</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>     <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>     <span class="at">log =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Grain size (mm)&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Cumulative proportion finer&quot;</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="fu">points</span>(test_output<span class="sc">$</span>dm, <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(test_output<span class="sc">$</span>Li))),</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>)</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="fu">lines</span>(test_output<span class="sc">$</span>dm, <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(test_output<span class="sc">$</span>Li))),</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>In this case the field-measured and the simulated grain size
distributions are quite similar, but larger differences can be expected
when the actual grain size distribution is not log-normally
distributed.</p>
</div>
<div id="see-also-3" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>estimate_capacity()</code>, <code>bank_erode_fp</code>,
<code>bank_erode_trc()</code></p>
<hr />
</div>
</div>
<div id="gbem" class="section level2">
<h2>gbem</h2>
<p>the GBEM function: gravel-bed river bank erosion model. This function
estimates the change in channel width for a flood of magnitude
<code>Q</code> and duration <code>t</code> based on the sediment
texture, slope, riparian vegetation type, and the channel width at the
beginning of the flood. It can also be implemented at a finer timescale
to predict the bank erosion during a flood hydrograph.</p>
<div id="usage-4" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>gbem(   Q,   t,   n,   D84,   D50,   W,   S,   H = 0,   fun = &quot;ec&quot;,   g = 9.81,   rho_s = 2650,   rho = 1000 )</code></p>
</div>
<div id="arguments-4" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>Q</code> discharge carried by the stream (m<span class="math inline">\(^3\)</span>/s)</p></li>
<li><p><code>t</code> time for which Q acts on the stream channel
(hrs)</p></li>
<li><p><code>n</code> Manning’s n value for the main channel</p></li>
<li><p><code>D84</code> 84th percentile of the surface grain size
distribution (m)</p></li>
<li><p><code>D50</code> 50th percentile of the grain size distribution
(m)</p></li>
<li><p><code>W</code> water surface width at the beginning of time
interval t</p></li>
<li><p><code>S</code> energy gradient of the stream channel
(m/m)</p></li>
<li><p><code>H</code> effective rooting depth for vegetation; grassy
banks, no trees / shrubs H = 0.35; 1 to 5 percent tree / shrub cover H =
0.50; 5 to 50 percent tree / shrub cover H = 0.90; more than 50 percent
tree / shrub cover H = 1.1</p></li>
<li><p><code>fun</code> choice of transport function. Default is Eaton
and Church (“ec”)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-4" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function implements the gravel bed bank erosion model (GBEM)
that is the core function used by STOCHASIM and the BGC stochastic bank
erosion model. It limits the amount of bank erosion that can occur in a
given timestep based on the bedload transport capacity of the stream
proximate to the channel banks. The output from this function is a
vector containing: (1) the predicted widening based only on a stability
criterion; (2) the predicted widening based on the stability criterion,
constrained by the bedload transport capacity; (4) the volume of bedload
that could be transported during the time step t in the near-bank
region; and (4) the critical depth for bank erosion</p>
</div>
<div id="output-4" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function outputs a vector containing a string of four numbers</p>
<ul>
<li>an estimate of the width increase based only on channel stability,
constrained by the ability of the river to transport bed material away
from the banks</li>
<li>an estimate of the flow depth following bank erosion</li>
<li>an estimate of the total beload transport volume per unit width of
the stream (m3/m)</li>
<li>an estimate of the critical depth for bank erosion to occur.</li>
</ul>
</div>
<div id="examples-4" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>Here is an example of a single calculation using GBEM.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co">#specify flood details</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>flood_mag <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>flood_dur <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#specify river reach details</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>river_n <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>river_d50 <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>river_d84 <span class="ot">&lt;-</span> <span class="fl">2.1</span> <span class="sc">*</span> river_d50</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>river_w0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>river_slope <span class="ot">&lt;-</span> <span class="fl">0.007</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>river_H <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#run the model</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>out_put <span class="ot">&lt;-</span> <span class="fu">gbem</span>(flood_mag, flood_dur, river_n, river_d84, river_d50, river_w0, river_slope, river_H)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#update the river width based on the modelled bank erosion</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>river_w1 <span class="ot">&lt;-</span> river_w0 <span class="sc">+</span> out_put[<span class="dv">2</span>]</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="fu">print</span>(river_w1)</span></code></pre></div>
<pre><code>## [1] 25.78269</code></pre>
<p>We can use the model to investigate the potential effects of a flood,
but also a disturbance such as a wildfire or riparian logging. The code
below simulates the effects on the stable channel width modeled above,
due to a loss of about half of the riparian bank strength. The modeled
bank strength loss is equivalent to transitioning from a cottonwood
forest to a grass field.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co">#change the bank strength</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>river_H <span class="ot">&lt;-</span> river_H <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#run the model using the stable width from the last model run</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>out_put <span class="ot">&lt;-</span> <span class="fu">gbem</span>(flood_mag, flood_dur, river_n, river_d84, river_d50, river_w1, river_slope, <span class="at">H =</span> river_H)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#update the river width based on the modelled bank erosion</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>river_w2 <span class="ot">&lt;-</span> river_w1 <span class="sc">+</span> out_put[<span class="dv">1</span>]</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="fu">print</span>(river_w2)</span></code></pre></div>
<pre><code>## [1] 46.60563</code></pre>
<p>Changes in bank strength have a very large potential effect on stable
channel dimensions, making floods that occur 5 to 10 years after an
intense wildfire in a riparian zone particularly hazardous.</p>
</div>
<div id="see-also-4" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>bank_erode_fp()</code>, <code>bank_erode_trc()</code></p>
<hr />
</div>
</div>
<div id="bank_erode_fp" class="section level2">
<h2>bank_erode_fp</h2>
<p>Estimate the cumulative bank erosion during a flood hydrograph for a
floodplain channel</p>
<div id="usage-5" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>bank_erode_fp(Q, t, n, D84, D50, W, S, H = 0, fun = &quot;ec&quot;)</code></p>
</div>
<div id="arguments-5" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>Q</code> a list of discharge values at regular time
intervals defining the flood hydrograph (m<span class="math inline">\(^3\)</span>/s)</p></li>
<li><p><code>t</code> time interval between discharge measurements
(hrs)</p></li>
<li><p><code>n</code> Manning’s n value for the main channel</p></li>
<li><p><code>D84</code> 84th percentile of the surface grain size
distribution (m)</p></li>
<li><p><code>D50</code> 50th percentile of the grain size distribution
(m)</p></li>
<li><p><code>W</code> water surface width at the beginning of time
interval t</p></li>
<li><p><code>S</code> energy gradient of the stream channel
(m/m)</p></li>
<li><p><code>H</code> effective rooting depth for vegetation</p></li>
<li><p><code>fun</code> choice of transport function. Default is Eaton
and Church (“ec”)</p></li>
<li><p><code>Z</code> height of the terrace above the channel bottom
(m)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-5" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function implements the GBEM model for estimating bank erosion
using the standard model for streams where the floodplain is assumed to
be equal to the critical depth based on the bed texture and slope. The
function outputs a data frame containing variables for time since the
start of the hydrograph (time), discharge values for each time (Q), the
predicted bank erosion distance for the time step (erosion), the volume
of sediment transport that the stream can convey during the timestep
(vb), the critical depth for bank erosion (dc), channel width at the end
of each timestep (wi)</p>
</div>
<div id="output-5" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function outputs a data frame with values for each time step in
the simulation. The variables in the data frame are:</p>
<ul>
<li>time (in hours)</li>
<li>discharge (in m<span class="math inline">\(^3\)</span>/s)</li>
<li>predicted bank erosion for the time step (in m)</li>
<li>volume of bedload transported across the entire channel during the
time step (in m<span class="math inline">\(^3\)</span>)</li>
<li>the critical depth for the occurrence of bank erosion (a constant
value, in m)</li>
<li>the simulated channel width at the end of each time step (m)</li>
</ul>
</div>
<div id="examples-5" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>Here is an example of the function</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co">#specify the flood hydrograph</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>flood_peak <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>time2peak <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>test_hydrograph <span class="ot">&lt;-</span> <span class="fu">scs_hydrograph</span>(flood_peak, time2peak, dt)[[<span class="dv">2</span>]]</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#specify river reach details</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>river_n <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>river_d50 <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>river_d84 <span class="ot">&lt;-</span> <span class="fl">2.1</span> <span class="sc">*</span> river_d50</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>river_w0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>river_slope <span class="ot">&lt;-</span> <span class="fl">0.007</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>river_H <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>out_put <span class="ot">&lt;-</span> <span class="fu">bank_erode_fp</span>(test_hydrograph, dt, river_n, river_d84, river_d50, river_w0, river_slope, river_H)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="fu">head</span>(out_put)</span></code></pre></div>
<pre><code>##   time    Q      depth erosion           Vb        dc wi
## 1    1 0.00 0.00000000       0 0.000000e+00 0.7826946 25
## 2    2 0.75 0.07833924       0 0.000000e+00 0.7826946 25
## 3    3 1.50 0.11874008       0 0.000000e+00 0.7826946 25
## 4    4 2.85 0.17452172       0 4.481413e-07 0.7826946 25
## 5    5 4.60 0.23259334       0 1.533149e-03 0.7826946 25
## 6    6 6.45 0.28489079       0 2.401352e-02 0.7826946 25</code></pre>
<p>The total change in width and the total volume of bedload transport
can be calculated from the data. Note that this estimate reflects the
decline in transport rate due to channel widening, resulting in a
hysteresis loop in the data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>total_width_increase <span class="ot">&lt;-</span> <span class="fu">sum</span>(out_put<span class="sc">$</span>erosion)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">print</span>(total_width_increase)</span></code></pre></div>
<pre><code>## [1] 15.9951</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>total_transport_volume <span class="ot">&lt;-</span> <span class="fu">sum</span>(out_put<span class="sc">$</span>Vb)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">print</span>(total_transport_volume)</span></code></pre></div>
<pre><code>## [1] 473.0646</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">plot</span>(out_put<span class="sc">$</span>Q, out_put<span class="sc">$</span>Vb,</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(Discharge<span class="sc">~</span>(m<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>s)),</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(Transport<span class="sc">~</span>volume<span class="sc">~</span>(m<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>s)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The volume that would be transported if bank erosion did not occur
can be estimated by putting in a very high bank strength value. However,
this analysis assumes that the channel is rectangular, and does not
capture the effects of changing channel width with flood stage. If bank
erosion can be ignored, it is more appropriate to use apply the
<code>estimate_capacity()</code> function above to a real cross section
instead of using functions relying on <code>gbem()</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co">#repeat analysis with higher bank strength</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>river_H <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>out_put <span class="ot">&lt;-</span> <span class="fu">bank_erode_fp</span>(test_hydrograph, dt, river_n, river_d84, river_d50, river_w0, river_slope, river_H)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>total_transport_volume <span class="ot">&lt;-</span> <span class="fu">sum</span>(out_put<span class="sc">$</span>Vb)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="fu">print</span>(total_transport_volume)</span></code></pre></div>
<pre><code>## [1] 689.7506</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">plot</span>(out_put<span class="sc">$</span>Q, out_put<span class="sc">$</span>Vb,</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(Discharge<span class="sc">~</span>(m<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>s)),</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(Transport<span class="sc">~</span>volume<span class="sc">~</span>(m<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>s)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="see-also-5" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>bank_erode_trc()</code> <code>gbem()</code></p>
<hr />
</div>
</div>
<div id="bank_erode_trc" class="section level2">
<h2>bank_erode_trc</h2>
<p>Estimate the cumulative bank erosion during a flood hydrograph in an
incized channel</p>
<div id="usage-6" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>bank_erode_trc(   Q,   t,   n,   D84,   D50,   W,   S,   H = 0,   Z,   fun = &quot;ec&quot;,   g = 9.81,   rho_s = 2650,   rho = 1000 )</code></p>
</div>
<div id="arguments-6" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>Q</code> a list of discharge values at regular time
intervals defining the flood hydrograph (m<span class="math inline">\(^3\)</span>/s)</p></li>
<li><p><code>t</code> time interval between discharge measurements
(hrs)</p></li>
<li><p><code>n</code> Manning’s n value for the main channel</p></li>
<li><p><code>D84</code> 84th percentile of the surface grain size
distribution (m)</p></li>
<li><p><code>D50</code> 50th percentile of the grain size distribution
(m)</p></li>
<li><p><code>W</code> water surface width at the beginning of time
interval t</p></li>
<li><p><code>S</code> energy gradient of the stream channel
(m/m)</p></li>
<li><p><code>H</code> effective rooting depth for vegetation grassy
banks, no trees / shrubs H = 0.35; 1 to 5percent tree / shrub cover H =
0.50; 5 to 50percent tree / shrub cover H = 0.90; more than 50percent
tree / shrub cover H = 1.1</p></li>
<li><p><code>Z</code> height of the terrace above the channel bottom
(m)</p></li>
<li><p><code>fun</code> choice of transport function. Default is Eaton
and Church (“ec”)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-6" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function implements the GBEM model for estimating bank erosion
using a simple adjustment parameter to adapt the standard model for
streams where the channel is incised, and confined by a terrace. The
function outputs a data frame containing variables for time since the
start of the hydrograph (time), discharge values for each time (Q), the
predicted bank erosion distance for the time step (erosion), the volume
of sediment transport that the stream can convey during the timestep
(vb), the critical depth for bank erosion (dc), channel width at the end
of each timestep (wi)</p>
</div>
<div id="output-6" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function outputs a data frame with values for each time step in
the simulation. The variables in the data frame are:</p>
<ul>
<li>time (in hours)</li>
<li>discharge (in m<span class="math inline">\(^3\)</span>/s)</li>
<li>predicted bank erosion for the time step (in m)</li>
<li>volume of bedload transported across the entire channel during the
time step (in m<span class="math inline">\(^3\)</span>)</li>
<li>the critical depth for the occurrence of bank erosion (a constant
value, in m)</li>
<li>the simulated channel width at the end of each time step (m)</li>
</ul>
</div>
<div id="examples-6" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>Here is an example of the function.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co">#use the flood hydrograph created above for bank_erode_fp</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co">#use the same river reach details as for bank_erode_fp</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>river_H <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>river_Z <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>out_put <span class="ot">&lt;-</span> <span class="fu">bank_erode_trc</span>(test_hydrograph, dt, river_n, river_d84, river_d50, river_w0, river_slope, river_H, river_Z)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="fu">head</span>(out_put)</span></code></pre></div>
<pre><code>##   time    Q      depth erosion           Vb        dc wi
## 1    1 0.00 0.00000000       0 0.000000e+00 0.7826946 25
## 2    2 0.75 0.07833924       0 0.000000e+00 0.7826946 25
## 3    3 1.50 0.11874008       0 0.000000e+00 0.7826946 25
## 4    4 2.85 0.17452172       0 4.481413e-07 0.7826946 25
## 5    5 4.60 0.23259334       0 1.533149e-03 0.7826946 25
## 6    6 6.45 0.28489079       0 2.401352e-02 0.7826946 25</code></pre>
<p>The total change in width and the total volume of bedload transport
can be calculated from the data. Note that this estimate reflects the
decline in transport rate due to channel widening, resulting in a
hysteresis loop in the data.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>total_width_increase <span class="ot">&lt;-</span> <span class="fu">sum</span>(out_put<span class="sc">$</span>erosion)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">print</span>(total_width_increase)</span></code></pre></div>
<pre><code>## [1] 9.378277</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>total_transport_volume <span class="ot">&lt;-</span> <span class="fu">sum</span>(out_put<span class="sc">$</span>Vb)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">print</span>(total_transport_volume)</span></code></pre></div>
<pre><code>## [1] 561.7546</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">plot</span>(out_put<span class="sc">$</span>Q, out_put<span class="sc">$</span>Vb,</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(Discharge<span class="sc">~</span>(m<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>s)),</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(Transport<span class="sc">~</span>volume<span class="sc">~</span>(m<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>s)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Compared to the same analysis using <code>bank_erode_fp()</code> the
amount of widening is lower and the total transport volume is higher,
reflecting the fact that this stream is confined by a terrace.</p>
</div>
<div id="see-also-6" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>bank_erode_fp()</code>, <code>gbem()</code></p>
<hr />
</div>
</div>
<div id="step_length" class="section level2">
<h2>step_length</h2>
<p>Calculating the step length for sediment transport of coarse bed
material</p>
<div id="usage-7" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>step_length(   D50,   q,   d,   S,   dt,   flashy = FALSE,   use_ferguson = TRUE,   g = 9.81,   rho = 1000 )</code></p>
</div>
<div id="arguments-7" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>D50</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>q</code> a list of specific discharge values for a
hydrograph (m3/s/m)</p></li>
<li><p><code>d</code> flow depth at the bankfull stage (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>dt</code> time interval between discharge measurements
(hrs)</p></li>
<li><p><code>flashy</code> a logical variable (true if the hydrograph is
short and flashy)</p></li>
<li><p><code>use_ferguson</code> logical variable for selecting the
ferguson equation for calculating the critical stream power}</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-7" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>this function calculates the average distance for bedload transport
during a flow of a given duration. This is a good tool for estimating
potential relations between sediment sources and sediment deposition
areas. It addresses only the coarse sediment that moves along the
channel bed, not the silt, sand and finer granules that can move in
saltation of suspension modes.</p>
</div>
<div id="output-7" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-7" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>Here is an example of the function in use for Fishtrap Creek, where
tracers were deployed in 2006.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co">#simulate the hydrograph</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">scs_hydrograph</span>(<span class="at">Qpeak =</span> <span class="dv">7</span>, </span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>                    <span class="at">tpeak =</span> <span class="dv">8</span>, </span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>                    <span class="at">dt =</span> <span class="dv">1</span>)[[<span class="dv">2</span>]]</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>q <span class="ot">&lt;-</span> Q <span class="sc">/</span> <span class="dv">6</span>  <span class="co">#channel is approximately 6 m wide</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fl">0.6</span>  <span class="co">#estimated bankfull depth</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>D50 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>Slope <span class="ot">&lt;-</span> <span class="fl">0.02</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a><span class="co">#use same values for stream evaluated in bank_erode_pf() and bank_erode_trc()</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a><span class="fu">step_length</span>(D50, q, d, Slope, <span class="dv">1</span>, <span class="at">flashy =</span> <span class="cn">FALSE</span>, <span class="at">use_ferguson =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 42.43703</code></pre>
<p>Typically, step length during a bankfull flow is on the order of 5 to
10 times the channel width, depending on the flood duration, which in
this case lines up with the estimate assuming that the flood was not
particularly flashing and using the Ferguson (2005) to estimate the
critical stream power for entrainment.</p>
<p>The estimation of step length is very sensitive to the quality of the
input data, particularly the estimate of the specific discharge value.
If little is known about the hydrograph shape, it is appropriate to
assume the flood is flashy, in which case a function using only the peak
specific discharge is used.</p>
</div>
<div id="see-also-7" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>crit_power()</code>, <code>unit_power()</code></p>
<hr />
</div>
</div>
<div id="quick_ffa_ann" class="section level2">
<h2>quick_ffa_ann</h2>
<p>This function uses the <code>RivRetrieve</code> package to source and
download all available daily discharge measurements for any Water Survey
of Canada of USGS gauging station, identify the maximum flows, and
perform a flood frequency analysis using maximum likelihood estimation
to fit a Generalized Extreme Value distribution to the data.</p>
<div id="usage-8" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>quick_ffa_ann(station, rp, qual)</code></p>
</div>
<div id="arguments-8" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<p><code>station</code> a string containing the station name
(e.g. ‘08GA022’ or ‘14048000’)</p>
<p><code>rp</code> a vector containing the return periods for which to
estimate flood quantiles. Default values are 2, 5, 10, 20, 50, 100, and
200 yrss</p>
<p><code>qual</code> a value from 0 to 1 specifying how complete an
annual dataset should be in order to estimate an annual maximum
discharge value for that year. Default value is 0.6.</p>
</div>
<div id="details-8" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>When applying this function for the first time to data from the Water
Survey of Canada, you will need to first run
<code>tidyhydat::download_hydat()</code> to download the hydat database
on your computer. Data from the USGS is provided from an online
repository and no additional installation in necessary.</p>
</div>
<div id="output-8" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function produces a graph showing the data and the fitted GEV
model, and outputs a data frame containing flood quantiles for the
specified return periods.</p>
</div>
<div id="examples-8" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<p>The following example shows the function applied to a USGS station
and a WSC station.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># if running for the first time, also run...</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="co"># tidyhydat::download_hydat()</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>wsc_test <span class="ot">&lt;-</span> <span class="fu">quick_ffa_ann</span>(<span class="st">&#39;08GA022&#39;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">print</span>(wsc_test)</span></code></pre></div>
<pre><code>##   return_period estimate
## 1             2     1090
## 2             5     1470
## 3            10     1750
## 4            20     2050
## 5            50     2490
## 6           100     2860
## 7           200     3270</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>usgs_test <span class="ot">&lt;-</span><span class="fu">quick_ffa_ann</span>(<span class="st">&#39;12150800&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in readNWISdv(site, param_code, start_date, end_date): NWIS servers are
## slated for decommission. Please begin to migrate to read_waterdata_daily.</code></pre>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/dv/?site=12150800&amp;format=waterml%2C1.1&amp;ParameterCd=00060&amp;StatCd=00003&amp;startDT=1900-01-01&amp;endDT=2025-12-10</code></pre>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA5FBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmZpBmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQZmaQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa2kJC227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDbtrbb27bb29vb2//b/7bb/9vb////tmb/25D/27b/29v//7b//9v////FxnlKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANYklEQVR4nO2dC3vcRhWG5bgO65KkSdchAUrT2IRAACsUbIiSkhS8Nrv6//+Huc/R9dNIGkm7Pt/zNLWkMxe9mjkzks6OkpzVqmTuCixdDAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCSh580H/s3p8mybN5K7O7SB7ehBxCld79+ChJjp5e642/fSgdFTtaitRygDaJ0LrNNL6CAYFKi0RKR+di4+7FgyIgtaM7oCw5umyvfnzB2pYFKp0lRvIk06QEqLKjVtYoVaQvRYl/epE8uBaNV2w+U7WV7fjotcpO57k9U1fNm4hUfxUbJ7qyn0Sz/uq1PNuV3BRX+dwU9tMLUciTy3IKt1sC+m8h2UfbRQy7j6TLuEqLHF6KIr83VdEnoI8fvRYt5UJmlRpQrjC941/mmhRyICdTBST18EYwkDr54NtpGRAxsVdKXc5U/70We1XeabEXayuawu9WFGiyzJWsAfntAiCzW55p5v7yRd+eitoYQL6wAqBKDoltm6UuJo4+vM6/yKyvdcay/qsb2VpKgIiJSHVyLf/V5t/e3J0JQ3HsXBmvdAniHH9xU01BdisKJJn85yb/lNhDZJtWWqTQ8Nb+BGwXO/r+ivYoWofUgy/l4E6mFpDsD6YTZR6KyKgIiJroVKKUlb1q2dMr08dIDxP6LIeVVV5I4Xer2pJk4vjJlaOr2NltWum02OZ8cabxn7y7oS3Z1oEAqubgqlYBpFqWOGzbmXWcZR9ETEwqddGpnzV83fbujU6xymkKstv2I5tMn6ByDZad3SaVtkVmvipO0h8aP2AutK+DB1STg2v49YA2iTt7a0kAqRZKTEqAVrZ2srOYhmav58kfP5+VAJHdrr3bZHcvdBF/Nof8Nqm0raFqdJVxbff57WmBh6uDB1STAwCk/YBv2zWAiElTC5KwSIV1z9+WAZHdOnEh2d3bR8p52nztdpcWpHMu1J3WYUgL8p41991K9U8z7KwLJjRPbb558k7vf+R5bWznXhdSkN07O6TQZPnu9yJLAl5t04KLHsQDEtkfvRKJfjp1gGgdGn1QB0B6BiHGIpFYj2JpYhzYWs0r1gUTmqcwf6acxblxZW6iq4YKmbjSguxuQ8ElUyOi7FfmIpNtWuniGES6mJsouiIrdagbxboAMpMcOrExLdTOcqhJIc/UVUn1eD9bdROqqg8qOGmS7L1zc/qQ36aVLs5iCCA6hVNOU057XB3sjso8qAug/O6NYKGnrHImffLOuB/hJZ/+w3hQZ1LMU82kX9le5fqhHkFO3mXldux3237kk6lR6ImfSbvtAiA9D35F95gSlb0e9uRU7uSa1EHtuKIzaZKDB5R3VLc7l5KKk6DYyaIoKiDhLXpQ7ZssjiICUk4q/AFKz2SxFBfQ0beh9emdLJb4kSsQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCEgD+vyHx0LfXQHj+ygJyATRJCq0kFVUku/eH/3u6mf59/8+//joWVCU6T1Qkr8vtJpPM8eSL07Jx1Kg8e2reSqyVCU/l/f8mzsZFQ/zQBrQ9mytIowHN55kbxQGKJUxyKs8XQHrjtntgcIAbc/O800i/hsclnPAgFIZGMeAGgzT1fZMxlNzF2swlEFLl7uLwXwOFtD05c4tBgTEgIAYEBADAuoOKGTaPWK5cyusBY3H6EAB5aMxOlxAue5tk5U7t/o66aGIDh7QZOXOLQYE1B3Q6ai/zTpAQOf57TcjPmkdmtNU6g7oQ7791XhN6AAB5fn2N+O96DlEQJsxF1Y6REDzlBtFx8fHXU3DH7kq7fdD++Pj7oTCAO0uhr8yDCw3hhoA1UILf+0zjpYHqKFNhbagsX6nvjQf1NjlAn3Q7dcjjWTLGsVaPFIooNNDcNIltTrs0C42/JVhYLnRBcaze+mkvfBwfz+dtFGXydA9dtLd5oqhXSw5FCfddSp9X+7FSs4m2r3YaJoYUHHu3B1PCKC/l+7Ctt93L2VAuQNluFBAIXhCAG2/KxC6+/UgNxQfkCJiwXhAYXiCutjdy2cumPzujV+Cr5eiA9JIHBj3v9B8QnyQXFrwq8e/ffn4UZI8HfjYIy6gY6MBvscqzEmrJSPpWujBxU3yVuPYAaKjVx88PUax3ZcvfcrpXW4feT50V7+8DnKYrzwQ60snP1BAebn1DMjqMAFRDcITDZBdf7jxnm0iQL1dj1McQJldY3XTtNjqJIAG08nDAW3lyuIpeCpEHhtlDe+J4gFyjWYMPMGANkeXmfwxSzsh8uCx6YdT0QD5m4tx8gt/oijbBPg51JwtyM6gx8ov/Jm0PGX0g7rMLhQ+vQ+qTBEHql8LStEbaPvosdFuAh80jnr5oGz4SvKRAI3beqR6jGJJMkKgUBxAI3cvqYOaKI7tf6QOaKJYefwzinq+9mn/nsUcw7zFMzKfYCdtPqVz3jpXnH6iSB6Rjax+wQtyJGsZ6aduQa71zA7INg3RLlrnilNOFP3biwUAsk1DtqDWyfRkE8XjokbKlaivDxoaKTQGoOPodPKeE0X5Gbd+4QsjvtUo44nDZ28nihU8kfhECqCKPlGcCk+kELyYw/xkZIxCnXQn1xNtojgxHKkoEWZxWtB03Yoq1s3q6BPFefBEG8XGnijOhScY0Cw/h5qLjVIgoFTcY8hv5k73yHW2pmMU6qTX+Ua+9kEP7TP7xKjplq1jufPCkQqfB93+8oP6r02Z+ni5vFsbBmh2PH1m0tvnlwiQHubVzxMHAVoAn1AfJM83XaMuZieKafNTkS7lzg5HKnSYT1fmi/JtchPFdDUA0ALo5NEmigZLM0uU3RIaj1IgIPgYw8hOpXcX/QAthk/wPGisFWDay12E99EKnwfFL3f+oYsoyvOgYeUuik/P92IRy10SHKlAHzTCXVh7uUvjEwKIvJjvfTeP3mosjs/CAskXh2dZgJbXfPIetxoyhLPpOeqwcpeIp88DszzPYyz6v8jmkw+I7hi53IXi6R3dEQvQwFwjKPR5kLoJvT0d7IRqAQ3NNIZCnbRaQChGGPBC+SxqmF+kGBBQ8IvDsb4vNjSDqRQ+D+Lvi7UY8vfFgCF/XwwZ8vfFgCF/X2y44SzZxRMDAtrXOOnJFPRMet11mcCFrLwwhqK0oFlXXhhZUQA1x0kf8nc15D+6i8E7sXvbglITdwgf2s+48sLYCgHkPqyB36/OuPLCyAoARCbQfDdfZ0hiX0a4Wd0bhQCCv+GJrPrKJm2b1SQtxwc1awYExICAGBDQOPFBw7RwQPOLAQExICAGBMSA9lkMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYENDcgFVBTeU2rn3LWvKXz5pvWXwbU2LUnaNTMgHYXotJZBUXTZ029uXwdvGk84Rq79gTNmhmQfttdeWHZ9PbAmes4isY3wVU7kKBZc3cxpcqVzVpPRJg3gG2265SgTosAVFkZI31c55mIue6D4DUVteuUoE5LAFQJppFB23ne9Kkhaa7bXLtPKdh1SVCrBQDa1A1XeePl3ljfC863aLfHgBqDserDlbQ57jElu/3tYs1xbbVjvTGHPrdst7dOuvZzOfps6i63X+GpfdSu2O3rMN/wO2J1IjVO2pu3z/tq7PZ0opjpoIlKxdOk9hsoxDxru3Oos2tN0Ky5u9jixYCAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBDQBIDs0nmFWIRN21JFqU5QCcWo+QaRi0fYXdTmKL9MOEiTAFJnuqHRCO2fW7IfaeiwfLMD1BT3uRm4BvR0gAoroXYB1Claxdo0ZtjQsjprOkD6tDPV1+QS+g//I89JnNj2+dvkwT/PfjhzES8GkIqj0glyY6QCq2x3lQEtbw0gGW2looqylTL9oFbpV1Flw5rQxC1IfqlVRjfJC761gGRX2p7J2HhztqQF+QTK6Fx3VbVusQwe3tiYHwlHQhINRpkquKpX94maIpoOUKZOTF56cSJFQGvzkTwbtuk/FEMSrHU/0rF0LkY81afvDt9+fan+9vF7Az8NNuEo5q6mqHIR0Hme+39yN4qtSwk0gVP9CZBzjWBjASlaK9mhjKklNPD7hFO1ILlkvnYfihUA5NxGIQEBJP7KKCAX9pmuTS7qsmjTvQCk45adP+gMiCaALWj7/C/PL8mApvrfvgBStXV114DWxd5TA6iQoM4HZcQHiWOPrSv3ifbBBylAanBR5yNQyROSX9UWHaEVEElgj7tRTB4qjGImfFxb2dDf/RnFdO0zs1JamkhvmiQ/tHcxl4Acb5wHmeB8b6WOLX8eNIk0ldtvKjCGfkP2UADpe7Gs6o/34F5sGokp9O1pFcY+3M3vtxgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAjo/0BeWRJ8bc5QAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">print</span>(usgs_test)</span></code></pre></div>
<pre><code>##   return_period estimate
## 1             2     1650
## 2             5     2150
## 3            10     2470
## 4            20     2780
## 5            50     3170
## 6           100     3460
## 7           200     3740</code></pre>
</div>
<div id="see-also-8" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>quick_ffa_dual()</code></p>
<hr />
</div>
</div>
<div id="quick_ffa_dual" class="section level2">
<h2>quick_ffa_dual</h2>
<p>Estimate flood quantiles for dual mechanism daily maximum flows</p>
<div id="usage-9" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>quick_ffa_dual(   station,   start = &quot;04-01&quot;,   end = &quot;07-01&quot;,   rp = c(2, 5, 10, 20, 50, 100, 200),   qual = 0.6 )</code></p>
</div>
<div id="arguments-9" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>station</code> a string containing the station name
(e.g. ‘08GA022’ or ‘14048000’)</p></li>
<li><p><code>start</code> a string specifying the beginning of the melt
window in MM-DD format</p></li>
<li><p><code>rp</code> a vector containing the return periods for which
to estimate flood quantiles</p></li>
<li><p><code>qual</code> a value from 0 to 1 specifying how complete an
annual dataset should be in order to estimate an annual maximum
discharge value for that year</p></li>
</ul>
</div>
<div id="details-9" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function loads data from WSC or USGS stations and fits a
generalized extreme value (GEV) distribution to the data using maximum
likelihood estimation.</p>
</div>
<div id="output-9" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
<p>The function produces a graph showing the data and the fitted GEV
model, and outputs a data frame containing flood quantiles for the
specified return periods.</p>
</div>
<div id="examples-9" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># if running for the first time, also run...</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="co"># tidyhydat::download_hydat()</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>wsc_test <span class="ot">&lt;-</span> <span class="fu">quick_ffa_dual</span>(<span class="st">&#39;08MF065&#39;</span>,</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>                           <span class="at">start =</span> <span class="st">&#39;04-01&#39;</span>,</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>                           <span class="at">end =</span> <span class="st">&#39;07-01&#39;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">print</span>(wsc_test)</span></code></pre></div>
<pre><code>##   return_period estimate
## 1             2      208
## 2             5      256
## 3            10      290
## 4            20      325
## 5            50      375
## 6           100      416
## 7           200      459</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>usgs_test <span class="ot">&lt;-</span><span class="fu">quick_ffa_dual</span>(<span class="st">&#39;12451000&#39;</span>,</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>                           <span class="at">start =</span> <span class="st">&#39;04-01&#39;</span>,</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>                           <span class="at">end =</span> <span class="st">&#39;07-01&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in readNWISdv(site, param_code, start_date, end_date): NWIS servers are
## slated for decommission. Please begin to migrate to read_waterdata_daily.</code></pre>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/dv/?site=12451000&amp;format=waterml%2C1.1&amp;ParameterCd=00060&amp;StatCd=00003&amp;startDT=1900-01-01&amp;endDT=2025-12-10</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">print</span>(usgs_test)</span></code></pre></div>
<pre><code>##   return_period estimate
## 1             2      232
## 2             5      300
## 3            10      345
## 4            20      391
## 5            50      455
## 6           100      519
## 7           200      619</code></pre>
</div>
<div id="see-also-9" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<p><code>quick_ffa_ann()</code></p>
</div>
</div>
<div id="max_min_timing" class="section level2">
<h2>max_min_timing</h2>
<hr />
</div>
<div id="flow_regime" class="section level2">
<h2>flow_regime</h2>
<hr />
</div>
</div>
<div id="hydraulics-functions" class="section level1">
<h1>Hydraulics Functions</h1>
<hr />
<div id="u_ferg" class="section level2">
<h2>u_ferg</h2>
<p>Estimating the mean flow velocity using the Ferguson 2007
equation.</p>
<div id="usage-10" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>u_ferg(R, S, d84, a1 = 6.5, a2 = 2.5, g = 9.81)</code></p>
</div>
<div id="arguments-10" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d84</code> 84th percentile diameter of bed sediment
(m)</p></li>
<li><p><code>a1</code> constant fit by Ferguson (2007). Defaults to
6.5</p></li>
<li><p><code>a2</code> constant fit by Ferguson (2007). Defaults to
2.5</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
</ul>
</div>
<div id="details-10" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses the Ferguson (2007) flow resistance law to
estimate the mean velocity of the flow using the bed surface D84</p>
</div>
<div id="output-10" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-10" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-10" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="tau_1d" class="section level2">
<h2>tau_1D</h2>
<p>Calculating the cross section average shear stress</p>
<div id="usage-11" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>tau_1D(R, S, g = 9.81, rho = 1000)</code></p>
</div>
<div id="arguments-11" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-11" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>this function calculates the average shear stress acting on the
channel boundary for a given cross section.</p>
</div>
<div id="output-11" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-11" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-11" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="t_star" class="section level2">
<h2>t_star</h2>
<p>Estimating the dimensionless shear stress</p>
<div id="usage-12" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>t_star(tau, d, g = 9.81, rho = 1000, rho_s = 2650)</code></p>
</div>
<div id="arguments-12" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>tau</code> the cross section-averaged shear stress
(Pa/m<span class="math inline">\(^2\)</span>)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-12" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function calculates the dimensionless shear stress using the bed
surface median grain size.</p>
</div>
<div id="output-12" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-12" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-12" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="unit_power" class="section level2">
<h2>unit_power</h2>
<p>Calculating the cross section average unit stream power</p>
<div id="usage-13" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>unit_power(q, S, g = 9.81, rho = 1000)</code></p>
</div>
<div id="arguments-13" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>q</code> specific discharge (m<span class="math inline">\(^3\)</span>/s/m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-13" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>this function calculates the unit stream power acting on the channel
boundary for a given cross section.</p>
</div>
<div id="output-13" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-13" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-13" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
</div>
<div id="sediment-transport-functions" class="section level1">
<h1>Sediment Transport Functions</h1>
<hr />
<div id="mpm" class="section level2">
<h2>mpm</h2>
<p>Estimating bedload transport using Meyer Peter and Muller</p>
<div id="usage-14" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>mpm(R, S, d, t_crit = 0.047, g = 9.81, rho = 1000, rho_s = 2650)</code></p>
</div>
<div id="arguments-14" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>t_crit</code> critical dimensionless shear stress. Defaults
to 0.047</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-14" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses a dimensionless form of the traditional Meyer
Peter and Muller equation to estimate the dimensionless bedload flux for
a given shear stress and characteristic grain size.</p>
</div>
<div id="output-14" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-14" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-14" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="wp" class="section level2">
<h2>wp</h2>
<p>Estimating bedload transport using Wong and Parker (2006)</p>
<div id="usage-15" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>wp(R, S, d, t_crit = 0.047, g = 9.81, rho = 1000, rho_s = 2650)</code></p>
</div>
<div id="arguments-15" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>t_crit</code> critical dimensionless shear stress. Defaults
to 0.047</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-15" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses a dimensionless form of a modified version of
Meyer Peter and Muller equation to estimate the dimensionless bedload
flux for a given shear stress and characteristic grain size. Using the
original Meyer Peter and Muller equation will produce higher transport
estimates and is more conservative than using this modified version.</p>
</div>
<div id="output-15" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-15" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-15" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="eb" class="section level2">
<h2>eb</h2>
<p>Estimating bedload transport using Einstein and brown (1950)</p>
<div id="usage-16" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>eb(R, S, d, g = 9.81, rho = 1000, rho_s = 2650, kv = 1e-06)</code></p>
</div>
<div id="arguments-16" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>kv</code> kinematic viscosity of water. Defaults to 1e<span class="math inline">\(^-6\)</span></p></li>
</ul>
</div>
<div id="details-16" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses a dimensionless form of Einstein and brown (1950)
bedload transport function for use with sand bed rivers and gravel bed
rivers.</p>
</div>
<div id="output-16" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-16" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-16" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="yln" class="section level2">
<h2>yln</h2>
<p>Estimating bedload transport using Yalin (1963)</p>
<div id="usage-17" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>yln(   R,   S,   d,   t_crit = t_crit_soul(d),   g = 9.81,   rho = 1000,   rho_s = 2650,   kv = 1e-06 )</code></p>
</div>
<div id="arguments-17" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>t_crit</code> critical dimensionless shear stress,
calculated using Soulsby (1997)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>kv</code> kinematic viscosity of water. Defaults to 1e<span class="math inline">\(^-6\)</span></p></li>
</ul>
</div>
<div id="details-17" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses a dimensionless form of Yalin’s (1963) bedload
transport function for use with sand bed rivers and gravel bed
rivers.</p>
</div>
<div id="output-17" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-17" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-17" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="vr" class="section level2">
<h2>vr</h2>
<p>Estimating bedload transport using Van Rijn (1984)</p>
<div id="usage-18" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>vr(   R,   S,   d,   t_crit = t_crit_vr(d, rho, rho_s, g, kv),   g = 9.81,   rho = 1000,   rho_s = 2650,   kv = 1e-06 )</code>
### Arguments {-}</p>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>t_crit</code> critical dimensionless shear stress</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>kv</code> kinematic viscosity of water. Defaults to 1e<span class="math inline">\(^-6\)</span></p></li>
</ul>
</div>
<div id="details-18" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses a dimensionless form of Van Rijn’s (1984) bedload
transport function for use with sand bed rivers.</p>
</div>
<div id="output-18" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-18" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-18" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="wc" class="section level2">
<h2>wc</h2>
<p>Estimating fractional bedload transport using Wilcock and Crowe
(2003) in m3/second</p>
<div id="usage-19" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>wc(R, S, gsd, Fsand, g = 9.81, rho = 1000, rho_s = 2650)</code></p>
</div>
<div id="arguments-18" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>gsd</code> a data frame describing the grain size
distribution created with function wolman_gsd()</p></li>
<li><p><code>Fsand</code> proportion of the surface that is covered by
sand sized sediment (affects entrainment, typically varies from 0 to
0.2)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>counts</code> number of stones in each size class size
class bounds (!!!must start with a 0!!!)</p></li>
</ul>
</div>
<div id="details-19" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses the Wilcock and Crowe transport function on
standard data from a surface Wolman count to estimate the
fraction-specific transport rate for a given shear stress. Output is a
data frame containing inputted GSD information for each size class (Di,
cpf, Dm, Fi), as well as the dimensionless transport rate (Wi), the
volumetric transport rate per unit width (qbi), and the fraction of the
computed bedload in each size class (Li)</p>
</div>
<div id="output-19" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-19" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-19" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="ec" class="section level2">
<h2>ec</h2>
<p>Estimating bed material transport using Eaton and Church (2011)</p>
<div id="usage-20" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>ec(   R,   S,   d,   d84 = 2 * d,   g = 9.81,   rho = 1000,   rho_s = 2650,   U = u_ferg(R, S, d84, a1, a2, g),   a1 = 6.5,   a2 = 2.5,   kv = 1e-06,   t_crit = t_crit_soul(d, rho, rho_s, g, kv) )</code></p>
</div>
<div id="arguments-19" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>d84</code> 84th percentile diameter of bed sediment (m).
Defaults to 2 * d</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>U</code> mean flow velocity. Defaults to flows calculated
using Ferguson</p>
<ol start="2007" style="list-style-type: decimal">
<li></li>
</ol></li>
<li><p><code>a1</code> constant fit by Ferguson (2007). Defaults to
6.5</p></li>
<li><p><code>a2</code> constant fit by Ferguson (2007). Defaults to
2.5</p></li>
<li><p><code>kv</code> kinematic viscosity of water. Defaults to 1e<span class="math inline">\(^-6\)</span></p></li>
<li><p><code>t_crit</code> critical dimensionless shear stress,
calculated using Soulsby (1997)</p></li>
</ul>
</div>
<div id="details-20" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses a dimensionless stream power equation from Eaton
and Church (2011) to estimate bed material load transport in sand bed
rivers and gravel bed rivers.</p>
</div>
<div id="output-20" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-20" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-20" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="rk" class="section level2">
<h2>rk</h2>
<p>Estimating bed material transport using Recking (2013)</p>
<div id="usage-21" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>rk(R, S, d, d84 = 2 * d, g = 9.81, rho = 1000, rho_s = 2650, rp = FALSE)</code></p>
</div>
<div id="arguments-20" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>d84</code> 84th percentile diameter of bed sediment (m).
Defaults to 2 * d</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rp</code> option to select equation suited to riffle pool
morphology, default is FALSE</p></li>
</ul>
</div>
<div id="details-21" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses a dimensionless shear stress equation from Recking
based on the D84 of the bed surface, and is the version for use with
field data.</p>
</div>
<div id="output-21" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-21" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-21" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
</div>
<div id="bed-entrainment-functions" class="section level1">
<h1>Bed Entrainment Functions</h1>
<hr />
<div id="qb_conversion" class="section level2">
<h2>qb_conversion</h2>
<p>Converting dimensionless bedload flux to volumetric flux</p>
<div id="usage-22" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>qb_conversion(q_star, d, g = 9.81, Gs = 1.65)</code></p>
</div>
<div id="arguments-21" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>q_star</code> dimensionless bedload flux}</p></li>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>Gs</code> the submerged specific gravity of sediment.
Defaults to 1.65</p></li>
</ul>
</div>
<div id="details-22" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>this function converts dimensionless bedload transport flux values to
fluxes in cubic meters per second per meter</p>
</div>
<div id="output-22" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-22" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-22" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="t_crit_soul" class="section level2">
<h2>t_crit_soul</h2>
<p>Estimating critical dimensionless shear stress</p>
<div id="usage-23" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>t_crit_soul(d, rho = 1000, rho_s = 2650, g = 9.81, kv = 1e-06)</code></p>
</div>
<div id="arguments-22" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>kv</code> kinematic viscosity of water. Defaults to 1e<span class="math inline">\(^-6\)</span></p></li>
</ul>
</div>
<div id="details-23" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>Using the equation published by Soulsby (1997), this function
estimates the critical dimensionless shear stress as a function of grain
size.</p>
</div>
<div id="output-23" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-23" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-23" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="t_crit_vr" class="section level2">
<h2>t_crit_vr</h2>
<p>Estimating critical dimensionless shear stress</p>
<div id="usage-24" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>t_crit_vr(d, rho = 1000, rho_s = 2650, g = 9.81, kv = 1e-06)</code></p>
</div>
<div id="arguments-23" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>kv</code> kinematic viscosity of water. Defaults to 1e<span class="math inline">\(^-6\)</span></p></li>
</ul>
</div>
<div id="details-24" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>Using the equation published by Van Rijn (1984), this function
estimates the critical dimensionless shear stress as a function of grain
size.</p>
</div>
<div id="output-24" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-24" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-24" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="t_ref_star" class="section level2">
<h2>t_ref_star</h2>
<p>Estimating reference dimensionless shear stress for Wilcock &amp;
Crowe (2003)</p>
<div id="usage-25" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>t_ref_star(Fsand)</code></p>
</div>
<div id="arguments-24" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><code>Fsand</code> Proportion of sand on the bed surface</li>
</ul>
</div>
<div id="details-25" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>Using the equation published by Wilcock &amp; Crow, this function
estimates the reference dimensionless shear stress based on the fraction
of sand on the bed.</p>
</div>
<div id="output-25" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-25" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-25" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="crit_power" class="section level2">
<h2>crit_power</h2>
<p>Estimating critical stream power for bed entrainment</p>
<div id="usage-26" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>crit_power(D50, d, use_ferguson = TRUE)</code></p>
</div>
<div id="arguments-25" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>D50</code> median bed sediment grain diameter (mm)</p></li>
<li><p><code>d</code> flow depth (m)</p></li>
</ul>
</div>
<div id="details-26" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>Using the equation published by Ferguson (2005) or Petit et
al. (2005), this function estimates the critical stream power as a
function of grain size, and flow depth. These empirical equations are
valid for D50 ranging from 20 to 150 mm</p>
</div>
<div id="output-26" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-26" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-26" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
</div>
<div id="data-import-analysis-simulation-functions" class="section level1">
<h1>Data Import / Analysis / Simulation Functions</h1>
<div id="scs_hydrography" class="section level2">
<h2>scs_hydrography</h2>
<p>Creating a hydrograph based on the Standard SCS Dimensionless Unit
Hydrograph</p>
<div id="usage-27" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>scs_hydrograph(Qpeak, tpeak, dt)</code></p>
</div>
<div id="arguments-26" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>Qpeak</code> the peak instantaneous discharge to be reached
during the hydrograph (cumecs)</p></li>
<li><p><code>tpeak</code> the lag time between the peak rainfall input
and the peak runoff (hours)</p></li>
<li><p><code>dt</code> a parameter that controls the time increment for
data output (in hours)</p></li>
</ul>
</div>
<div id="details-27" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function uses the Soil Conservation Service Standard Unit
Hydrograph to simulate a simple hydrograph associated with a rainfall
event. The hydrograph depends on a parameter controlling the peak flow
that will be reached and a parameter controlling how quickly the
hydrograph will rise and fall. The shape of the hydrograph remains the
same.</p>
<p>The dimensionless unit hydrograph used by the SCS was developed by
Victor Mockus and was derived based on a large number of unit
hydrographs from basins that varied in characteristics such as size and
geographic location. The unit hydrographs were averaged and the final
product was made dimensionless by considering the ratios of Q/Qpeak
(flow/peak flow) on the ordinate axis and t/tpeak (time/time to peak) on
the abscissa. This final, dimensionless unit hydrograph, which is the
result of averaging a large number of individual dimensionless unit
hydrographs, has a time-to-peak located at approximately 20 percent of
its time base and an inflection point at 1.7 times the time-to-peak.</p>
</div>
<div id="output-27" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-27" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-27" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="wolman_gsd" class="section level2">
<h2>wolman_gsd</h2>
<p>Processing Wolman count data into grain size distribution</p>
<div id="usage-28" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>wolman_gsd(Di, counts)</code></p>
</div>
<div id="arguments-27" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>Di</code> a list of grain sizes representing the upper
bounds of the size classes</p></li>
<li><p><code>counts</code> the number of stones sampled in the szie
class defined by the upper bound values, Di</p></li>
</ul>
<p>This function uses standard data from a surface Wolman count to
estimate cumulative percent finer for each size, the fraction of the
distribution in a given size class, and the median size of each size
class. Output is a data frame containing the upper limit of each size
class (Di), the cumulative proportion finer than the size listed in Di
(cpf), the median size for each size class (Dm), and the fraction of the
distribution in each class (Fi)</p>
</div>
<div id="output-28" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-28" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-28" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="make_trapezoid" class="section level2">
<h2>make_trapezoid</h2>
<p>Create a cross section based on measured trapezoid dimensions</p>
<div id="usage-29" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>make_trapezoid(w_top, w_bot, H_bank, Z_fp, dx = 0.1)</code></p>
</div>
<div id="arguments-28" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>w_top</code> measured or estimated top width of the
trapezoid (m)</p></li>
<li><p><code>w_bot</code> measured or estimated bottom width of the
trapezoid (m)</p></li>
<li><p><code>H_bank</code> measures or estimated vertical height of the
trapezoid (m)</p></li>
<li><p><code>dx</code> a parameter controlling the spacing between
exported data points on the section</p></li>
<li><p><code>z_fp</code> elevation of the top of the trapezoid (i.e. the
floodplain or terrace elevation, m)</p></li>
</ul>
</div>
<div id="details-28" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function creates profile data including the distance along the
profile from the left bank.</p>
</div>
<div id="output-29" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-29" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-29" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
<hr />
</div>
</div>
<div id="load_section" class="section level2">
<h2>load_section</h2>
<p>Load cross section data</p>
<div id="usage-30" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>load_section(xs_nm, dx = NA, rev = FALSE, trim = FALSE, mkplt = FALSE)</code></p>
</div>
<div id="arguments-29" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>xs_nm</code> path to a csv file with 3 columns containing
the profile data</p></li>
<li><p><code>dx</code> optional dist. increment to resample section at
regular intervals (m)</p></li>
<li><p><code>rev</code> option to reverse the direction in which
distance is measured</p></li>
<li><p><code>trim</code> option to identify left &amp; right banks and
trim section</p></li>
<li><p><code>mkplt</code> option to make a plot of the data (original
&amp; resampled/trimed)</p></li>
</ul>
</div>
<div id="details-29" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function loads profile data that is saved in a text file (XYZ
format) and calculates the distance along the profile from the first
data point in the file. The function assumes that the first row is
header information, and that the data in column 1 correspond to x
coordinates (or eastings), column 2 corresponds to y coordinates
(northings), and column 3 corresponds to elevation.</p>
</div>
<div id="output-30" class="section level3 unnumbered">
<h3 class="unnumbered">Output</h3>
</div>
<div id="examples-30" class="section level3 unnumbered">
<h3 class="unnumbered">Examples</h3>
</div>
<div id="see-also-30" class="section level3 unnumbered">
<h3 class="unnumbered">See also</h3>
</div>
</div>
</div>
<div id="utility-functions" class="section level1">
<h1>Utility Functions</h1>
<div id="find_q_b" class="section level2">
<h2>find_q_b</h2>
<p>Calculating volumetric unit transport rate for a specified
function</p>
<div id="usage-31" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>find_q_b(R, S, D50, D84, fun = &quot;ec&quot;, g = 9.81, rho = 1000, rho_s = 2650)</code></p>
</div>
<div id="arguments-30" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>R</code> hydraulic radius for the flow (m)</p></li>
<li><p><code>S</code> gradient of the water surface slope (m/m)</p></li>
<li><p><code>D50</code> 50th percentile of the grain size distribution
(m)</p></li>
<li><p><code>D84</code> 84th percentile of the surface grain size
distribution (m)</p></li>
<li><p><code>fun</code> choice of transport function. Default is Eaton
and Church (“ec”)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
<li><p><code>rho_s</code> sediment density. Defaults to 2650 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-30" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>This function takes the hydraulic data required to calculate the
dimensionless shear stress and uses a specified bedload transport
function to calculate the volumetric transport rate per unit width.</p>
<hr />
</div>
</div>
<div id="find_d_crit" class="section level2">
<h2>find_d_crit</h2>
<p>find the critical depth at which bank erosion will begin</p>
<div id="usage-32" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>find_d_crit(Q, H, t_c84, S, g = 9.81, rho = 1000, tol = 0.001)</code></p>
</div>
<div id="arguments-31" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>Q</code> a list of discharge values at regular time
intervals defining the flood hydrograph (m<span class="math inline">\(^3\)</span>/s)</p></li>
<li><p><code>H</code> effective rooting depth for vegetation</p></li>
<li><p><code>t_c84</code> stress required to entrain the 84th percentile
of the bed surface</p></li>
<li><p><code>S</code> energy gradient of the stream channel
(m/m)</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>rho</code> fluid density. Defaults to 1000 kg/m<span class="math inline">\(^3\)</span></p></li>
</ul>
</div>
<div id="details-31" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>this is a utility function used by GBEM to determine the typical
floodplain thickness above the channel bed. ***</p>
</div>
</div>
<div id="est_mu" class="section level2">
<h2>est_mu</h2>
<p>estimate relative bank strength</p>
<div id="usage-33" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>est_mu(H, d)</code></p>
</div>
<div id="arguments-32" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>H</code> effective rooting depth for vegetation}</p></li>
<li><p><code>d</code> channel depths}</p></li>
</ul>
</div>
<div id="details-32" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>this is a utility function used by GBEM to determine the relative
bank strength given the channel depth and rooting depth. It returns a
variable that is the bank strength relative to the bed strengths.</p>
<hr />
</div>
</div>
<div id="d_star" class="section level2">
<h2>d_star</h2>
<p>Estimating dimensionless particle size</p>
<div id="usage-34" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>d_star(d, Gs = 1.65, g = 9.81, kv = 1e-06)</code></p>
</div>
<div id="arguments-33" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>d</code> median bed sediment grain diameter (m)</p></li>
<li><p><code>Gs</code> the submerged specific gravity of sediment.
Defaults to 1.65</p></li>
<li><p><code>g</code> the acceleration of gravity. defaults to 9.81
m/s<span class="math inline">\(^2\)</span></p></li>
<li><p><code>kv</code> kinematic viscosity of water. Defaults to 1e<span class="math inline">\(^-6\)</span></p></li>
</ul>
</div>
<div id="details-33" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>this function estimates the dimensionless particle size</p>
<hr />
</div>
</div>
<div id="calc_depths" class="section level2">
<h2>calc_depths</h2>
<div id="usage-35" class="section level3 unnumbered">
<h3 class="unnumbered">Usage</h3>
<p><code>calc_depths(xs_data, wse, mkplt = F)</code></p>
</div>
<div id="arguments-34" class="section level3 unnumbered">
<h3 class="unnumbered">Arguments</h3>
<ul>
<li><p><code>xs_data</code> a data frame containing $dist (distances)
and $z (elevations)</p></li>
<li><p><code>wse</code> elevation of the water surface of interest
(m)</p></li>
<li><p><code>mkplt</code> logical option to plot the data, default is
FALSE}</p></li>
</ul>
</div>
<div id="details-34" class="section level3 unnumbered">
<h3 class="unnumbered">Details</h3>
<p>this function uses a water surface elevation (WSE) and the location
index for the channel thalweg to calculate the depths in the main
channel. disconnected areas outside the main channel that are below the
WSE are located and assigned a depth of NA. This is particularly
important on a fan</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
